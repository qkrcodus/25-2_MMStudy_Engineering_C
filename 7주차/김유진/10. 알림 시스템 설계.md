- 알림 시스템의 3가지 종류
  - 모바일 푸시 알림
  - SMS 메시지
  - 이메일

## 1. 문제 이해 및 설계 범위 확정
- 어떤 종류의 알림을 지원하는지
- 실시간 시스템인지
- 어떤 종류의 단말을 지원해야 하는지
- 사용자에게 보낼 알림은 누가 만들 수 있는지
- 사용자가 알림을 받지 않도록(opt-out) 설정할 수 있는지
- 하루에 몇 건의 알림을 보낼 수 있어야 하는지

## 2. 개략적 설계안 제시 및 동의 구하기
- 알림 유형별 지원 방안
  - iOS 푸시 알림
    - 알림 제공자: 알림 요청을 만들어 APNS(Apple Push Notification Service)로 보내는 주체
    - 단말 토큰: 알림 요청을 보내는 데 필요한 고유 식별자
    - 페이로드(payload): 알림 내용을 담은 JSON 딕셔너리
    - APNS: 푸시 알림을 iOS 장치로 보내는 역할의 애플이 제공하는 원격 서비스
    - iOS 단말: 푸시 알림을 수신하는 사용자 단말
  - 안드로이드 푸시 알림
    - iOS 푸시 알림과 비슷하나 APNS 대신 FCM(Firebase Cloud Messaging)을 사용
  - SMS 메세지
    - Twilio, Nexmo 같은 제 3 사업자의 서비스 이용
  - 이메일
    - Sendgrid, Mailchimp 같은 상용 이메일 서비스 이용
- 연락처 정보 수집 절차
  - 사용자가 앱을 설치하거나 처음으로 계정을 등록하면 API 서버는 해당 사용자의 정보를 수집하여 데이터베이스에 저장
  - 이때 이메일 주소와 전화번호는 user 테이블에 저장하고, 단말 토큰은 device 테이블에 저장(한 사용자가 여러 단말을 가질 수 있기 때문)
- 알림 전송 및 수신 절차(초안)
  - 1 - N 서비스
  - 알림 시스템: 1개 서버만 사용한다고 가정, 알림 전송 API를 제공하고, 제 3자 서비스에 전달할 알림 페이로드를 만들어 내야 한다
  - 제 3자 서비스
    - 확장성: 쉽게 새로운 서비스를 통합하거나 기존 서비스를 제거할 수 있어야 함
    - 어떤 서비스는 다른 시장에서 사용할 수 없음(ex: FCM을 중국에서 사용할 수 없음)
- 초안의 문제점
  - SPOF: 서버 하나의 장애가 전체 서비스의 장애로 이어진다
  - 규모 확장성: 한 대 서비스로 푸시 알림에 관계된 모든 것을 처리하므로, 데이터베이스나 캐시 등 중요 컴포넌트 규모를 개별적으로 늘릴 방법이 없다
  - 성능 병목: 사용자 트래픽이 많이 몰리면 시스템 과부하 상태에 빠질 수 있다
- 개선된 버전
  - 데이터베이스와 캐시를 알림 시스템의 주 서버에서 분리
  - 알림 서버를 증설하고 자동적으로 수평적 규모 확장이 이루어질 수 있도록
  - 메시지 큐를 이용해 시스템 컴포넌트 사이의 강한 결합을 끊는다
  - 


## 3. 상세 설계

## 4. 마무리
